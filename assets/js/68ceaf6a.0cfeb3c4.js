"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[3743],{5007:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"module1/chapter2","title":"Building ROS 2 Nodes with Python (rclpy)","description":"Learn how to create ROS 2 nodes using rclpy, including publishers, subscribers, services, and parameters.","source":"@site/docs/module1/chapter2.mdx","sourceDirName":"module1","slug":"/module1/chapter2","permalink":"/book/docs/module1/chapter2","draft":false,"unlisted":false,"editUrl":"https://github.com/Rao-Faizan/book/tree/master/docs/module1/chapter2.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Building ROS 2 Nodes with Python (rclpy)","description":"Learn how to create ROS 2 nodes using rclpy, including publishers, subscribers, services, and parameters.","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Understanding ROS 2 Architecture and Core Concepts","permalink":"/book/docs/module1/chapter1"},"next":{"title":"Bridging Python AI Agents to ROS 2 Controllers","permalink":"/book/docs/module1/chapter3"}}');var i=n(4848),l=n(8453);const c={title:"Building ROS 2 Nodes with Python (rclpy)",description:"Learn how to create ROS 2 nodes using rclpy, including publishers, subscribers, services, and parameters.",sidebar_position:2},t=void 0,o={},a=[{value:"rclpy Library Structure and Imports",id:"rclpy-library-structure-and-imports",level:2},{value:"Node Initialization and Creation",id:"node-initialization-and-creation",level:2},{value:"Creating Publishers",id:"creating-publishers",level:2},{value:"Creating Subscribers",id:"creating-subscribers",level:3},{value:"Timer Creation for Periodic Publishing",id:"timer-creation-for-periodic-publishing",level:3},{value:"Service Server Implementation",id:"service-server-implementation",level:3},{value:"Service Client Implementation",id:"service-client-implementation",level:3},{value:"Callback Functions and Callback Groups",id:"callback-functions-and-callback-groups",level:3},{value:"Standard Message Types",id:"standard-message-types",level:3},{value:"Parameter Declaration and Access",id:"parameter-declaration-and-access",level:3},{value:"QoS Profiles in Practice",id:"qos-profiles-in-practice",level:3},{value:"Debugging Techniques",id:"debugging-techniques",level:3},{value:"Using ROS 2 CLI Tools",id:"using-ros-2-cli-tools",level:4},{value:"Recommended VS Code Debugging Features",id:"recommended-vs-code-debugging-features",level:4}];function d(e){const r={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h2,{id:"rclpy-library-structure-and-imports",children:"rclpy Library Structure and Imports"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.code,{children:"rclpy"})," is the Python client library for ROS 2. To start creating ROS 2 nodes with Python, you need to understand the basic structure and import the necessary modules."]}),"\n",(0,i.jsx)(r.p,{children:"The core modules you'll use are:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy"}),": The main entry point for using ",(0,i.jsx)(r.code,{children:"rclpy"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.node"}),": For creating and working with nodes."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.publisher"}),": For creating publishers."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.subscription"}),": For creating subscribers."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.service"}),": For creating services."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.client"}),": For creating clients."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.timer"}),": For creating timers."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.parameter"}),": For working with parameters."]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Here's how you import these modules:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom rclpy.publisher import Publisher\r\nfrom rclpy.subscription import Subscription\r\nfrom rclpy.service import Service\r\nfrom rclpy.client import Client\r\nfrom rclpy.timer import Timer\r\nfrom rclpy.parameter import Parameter\n"})}),"\n",(0,i.jsx)(r.h2,{id:"node-initialization-and-creation",children:"Node Initialization and Creation"}),"\n",(0,i.jsxs)(r.p,{children:["In ",(0,i.jsx)(r.code,{children:"rclpy"}),", a node represents a computational unit in the ROS 2 network. To create a node, you first need to initialize ",(0,i.jsx)(r.code,{children:"rclpy"}),", then create a class that inherits from ",(0,i.jsx)(r.code,{children:"rclpy.node.Node"}),"."]}),"\n",(0,i.jsx)(r.p,{children:"Here's a basic example:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass MyNode(Node):\r\n    def __init__(self):\r\n        super().__init__('my_node')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MyNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["We import ",(0,i.jsx)(r.code,{children:"rclpy"})," and ",(0,i.jsx)(r.code,{children:"rclpy.node"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["We create a class ",(0,i.jsx)(r.code,{children:"MyNode"})," that inherits from ",(0,i.jsx)(r.code,{children:"Node"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["In the constructor, we call the superclass constructor with the node name ",(0,i.jsx)(r.code,{children:"'my_node'"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["In the ",(0,i.jsx)(r.code,{children:"main"})," function, we initialize ",(0,i.jsx)(r.code,{children:"rclpy"}),", create an instance of ",(0,i.jsx)(r.code,{children:"MyNode"}),", spin the node (which keeps it alive and processing callbacks), destroy the node, and shutdown ",(0,i.jsx)(r.code,{children:"rclpy"}),"."]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"creating-publishers",children:"Creating Publishers"}),"\n",(0,i.jsxs)(r.p,{children:["In ROS 2, publishers are responsible for sending messages to topics. To create a publisher, you need to use the ",(0,i.jsx)(r.code,{children:"create_publisher"})," method of the ",(0,i.jsx)(r.code,{children:"Node"})," class."]}),"\n",(0,i.jsx)(r.p,{children:"Here's an example of creating a publisher:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from std_msgs.msg import String\r\n\r\nclass MyNode(Node):\r\n    def __init__(self):\r\n        super().__init__('my_node')\r\n        self.publisher_ = self.create_publisher(String, 'my_topic', 10)\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["We import the ",(0,i.jsx)(r.code,{children:"String"})," message type from the ",(0,i.jsx)(r.code,{children:"std_msgs.msg"})," module."]}),"\n",(0,i.jsxs)(r.li,{children:["In the constructor of ",(0,i.jsx)(r.code,{children:"MyNode"}),", we create a publisher using ",(0,i.jsx)(r.code,{children:"self.create_publisher"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["The first argument is the message type (",(0,i.jsx)(r.code,{children:"String"}),")."]}),"\n",(0,i.jsxs)(r.li,{children:["The second argument is the topic name (",(0,i.jsx)(r.code,{children:"'my_topic'"}),")."]}),"\n",(0,i.jsx)(r.li,{children:"The third argument is the queue size (10)."}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"creating-subscribers",children:"Creating Subscribers"}),"\n",(0,i.jsxs)(r.p,{children:["Subscribers are used to receive messages published on topics. To create a subscriber, you use the ",(0,i.jsx)(r.code,{children:"create_subscription"})," method."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from std_msgs.msg import String\r\n\r\nclass MySubscriberNode(Node):\r\n    def __init__(self):\r\n        super().__init__('my_subscriber_node')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'my_topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.get_logger().info('Subscriber created, waiting for messages...')\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MySubscriberNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["We create a ",(0,i.jsx)(r.code,{children:"MySubscriberNode"})," that inherits from ",(0,i.jsx)(r.code,{children:"Node"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["Inside the constructor, ",(0,i.jsx)(r.code,{children:"self.create_subscription"})," is used to subscribe to the ",(0,i.jsx)(r.code,{children:"'my_topic'"})," topic."]}),"\n",(0,i.jsxs)(r.li,{children:["The ",(0,i.jsx)(r.code,{children:"listener_callback"})," method is defined to process incoming messages. This method will be called whenever a new message arrives on the topic."]}),"\n",(0,i.jsxs)(r.li,{children:["The ",(0,i.jsx)(r.code,{children:"get_logger().info"})," is used to print messages, which is the standard way to log in ROS 2."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"timer-creation-for-periodic-publishing",children:"Timer Creation for Periodic Publishing"}),"\n",(0,i.jsx)(r.p,{children:"Timers allow nodes to execute a callback function at a specified rate. This is commonly used for periodic publishing of data."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass MinimalPublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        self.timer = self.create_timer(0.5, self.timer_callback)  # Timer calls callback every 0.5 seconds\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = f'Hello from publisher: {self.i}'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    minimal_publisher = MinimalPublisher()\r\n    rclpy.spin(minimal_publisher)\r\n    minimal_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["We create a ",(0,i.jsx)(r.code,{children:"create_timer"})," with a period of 0.5 seconds, which calls ",(0,i.jsx)(r.code,{children:"timer_callback"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:["The ",(0,i.jsx)(r.code,{children:"timer_callback"})," function creates and publishes a ",(0,i.jsx)(r.code,{children:"String"})," message."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"service-server-implementation",children:"Service Server Implementation"}),"\n",(0,i.jsx)(r.p,{children:"Services provide a synchronous request-response mechanism. A service server waits for requests, processes them, and sends back a response."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts # Assuming this service type exists\r\n\r\nclass MinimalService(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_service')\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n        self.get_logger().info('Service server started.')\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f'Incoming request: a={request.a}, b={request.b}, sending response: {response.sum}')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    minimal_service = MinimalService()\r\n    rclpy.spin(minimal_service)\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["We import ",(0,i.jsx)(r.code,{children:"AddTwoInts"})," service type (you might need to create an ",(0,i.jsx)(r.code,{children:"example_interfaces"})," package or use an existing service type)."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"create_service"})," registers the ",(0,i.jsx)(r.code,{children:"add_two_ints_callback"})," function to handle requests on the ",(0,i.jsx)(r.code,{children:"add_two_ints"})," service."]}),"\n",(0,i.jsxs)(r.li,{children:["The callback function receives a ",(0,i.jsx)(r.code,{children:"request"})," and populates the ",(0,i.jsx)(r.code,{children:"response"})," with the sum."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"service-client-implementation",children:"Service Client Implementation"}),"\n",(0,i.jsx)(r.p,{children:"A service client sends a request to a service server and waits for its response."}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\nimport sys\r\n\r\nclass MinimalClientAsync(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_client_async')\r\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('service not available, waiting again...')\r\n        self.req = AddTwoInts.Request()\r\n\r\n    def send_request(self, a, b):\r\n        self.req.a = a\r\n        self.req.b = b\r\n        self.future = self.cli.call_async(self.req)\r\n        rclpy.spin_until_future_complete(self, self.future)\r\n        return self.future.result()\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    minimal_client = MinimalClientAsync()\r\n    response = minimal_client.send_request(int(sys.argv[1]), int(sys.argv[2]))\r\n    minimal_client.get_logger().info(f'Result of add_two_ints: {response.sum}')\r\n    minimal_client.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"create_client"})," creates a client for the ",(0,i.jsx)(r.code,{children:"add_two_ints"})," service."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"send_request"})," populates the request and calls the service asynchronously using ",(0,i.jsx)(r.code,{children:"call_async"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"rclpy.spin_until_future_complete"})," blocks until the response is received."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"callback-functions-and-callback-groups",children:"Callback Functions and Callback Groups"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Callback functions"})," are essential for event-driven programming in ROS 2. They are executed when a specific event occurs, such as a new message on a topic, a service request, or a timer expiring."]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Callback groups"})," allow you to manage the execution of multiple callbacks. By default, all callbacks in a node belong to a single default callback group, which executes them sequentially. For concurrent execution, you can create multiple callback groups and assign callbacks to them. This is advanced usage and typically not needed for basic nodes, but it's important for ensuring real-time performance in complex systems."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass MyConcurrentNode(Node):\r\n    def __init__(self):\r\n        super().__init__('my_concurrent_node')\r\n        # Default callback group (sequential execution)\r\n        self.subscription_ = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.default_callback,\r\n            10)\r\n        self.timer_ = self.create_timer(1.0, self.timer_callback)\r\n\r\n    def default_callback(self, msg):\r\n        self.get_logger().info(f'Default callback received: \"{msg.data}\"')\r\n\r\n    def timer_callback(self):\r\n        self.get_logger().info('Timer callback triggered.')\r\n\r\n# For concurrent execution, you would create different callback groups.\r\n# Example (conceptual, requires more setup for executor):\r\n# from rclpy.callback_groups import ReentrantCallbackGroup\r\n# self.reentrant_group = ReentrantCallbackGroup()\r\n# self.subscription_reentrant = self.create_subscription(\r\n#     String,\r\n#     'reentrant_topic',\r\n#     self.reentrant_callback,\r\n#     10,\r\n#     callback_group=self.reentrant_group)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MyConcurrentNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"standard-message-types",children:"Standard Message Types"}),"\n",(0,i.jsxs)(r.p,{children:["ROS 2 uses a variety of standard message types to facilitate communication between nodes. These messages are defined in packages like ",(0,i.jsx)(r.code,{children:"std_msgs"}),", ",(0,i.jsx)(r.code,{children:"geometry_msgs"}),", ",(0,i.jsx)(r.code,{children:"sensor_msgs"}),", and ",(0,i.jsx)(r.code,{children:"rcl_interfaces"}),". Understanding these common message types is crucial for building interoperable ROS 2 applications."]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"std_msgs"})}),": Contains basic data types like ",(0,i.jsx)(r.code,{children:"String"}),", ",(0,i.jsx)(r.code,{children:"Int32"}),", ",(0,i.jsx)(r.code,{children:"Bool"}),", ",(0,i.jsx)(r.code,{children:"Float64"}),", etc."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"geometry_msgs"})}),": Used for geometric primitives such as ",(0,i.jsx)(r.code,{children:"Point"}),", ",(0,i.jsx)(r.code,{children:"Pose"}),", ",(0,i.jsx)(r.code,{children:"Quaternion"}),", ",(0,i.jsx)(r.code,{children:"Twist"})," (linear and angular velocity), and ",(0,i.jsx)(r.code,{children:"Transform"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"sensor_msgs"})}),": Contains messages for common sensor data, including ",(0,i.jsx)(r.code,{children:"Image"}),", ",(0,i.jsx)(r.code,{children:"LaserScan"}),", ",(0,i.jsx)(r.code,{children:"Imu"})," (Inertial Measurement Unit), and ",(0,i.jsx)(r.code,{children:"PointCloud2"}),"."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"rcl_interfaces"})}),": Provides common interfaces for ROS 2, such as ",(0,i.jsx)(r.code,{children:"ParameterDescriptor"})," and ",(0,i.jsx)(r.code,{children:"SetParametersResult"})," for parameter management, and ",(0,i.jsx)(r.code,{children:"Log"})," for logging messages."]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"To use these message types, you typically import them as shown in the examples:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from std_msgs.msg import String\r\nfrom geometry_msgs.msg import Twist\r\nfrom sensor_msgs.msg import Image\n"})}),"\n",(0,i.jsx)(r.h3,{id:"parameter-declaration-and-access",children:"Parameter Declaration and Access"}),"\n",(0,i.jsxs)(r.p,{children:["Parameters allow you to configure nodes at runtime without recompiling the code. This is useful for adjusting behaviors, such as a PID controller's gains or a camera's exposure setting. ",(0,i.jsx)(r.code,{children:"rclpy"})," provides methods to declare, get, and set parameters."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom rclpy.parameter import Parameter\r\n\r\nclass ParameterNode(Node):\r\n    def __init__(self):\r\n        super().__init__('parameter_node')\r\n        self.declare_parameter('my_parameter', 'hello')\r\n        self.declare_parameter('an_integer_parameter', 1)\r\n\r\n        param = self.get_parameter('my_parameter')\r\n        self.get_logger().info(f'Initial parameter value: {param.value}')\r\n\r\n        # You can also get a parameter directly as a type\r\n        int_param = self.get_parameter('an_integer_parameter').value\r\n        self.get_logger().info(f'Integer parameter value: {int_param}')\r\n\r\n        # Setting a parameter\r\n        self.set_parameters([Parameter('my_parameter', Parameter.Type.STRING, 'world')])\r\n        new_param = self.get_parameter('my_parameter')\r\n        self.get_logger().info(f'New parameter value: {new_param.value}')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = ParameterNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"In this example:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"declare_parameter()"})," is used to define a parameter with a default value."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"get_parameter()"})," retrieves the current value of a parameter."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"set_parameters()"})," allows you to change parameter values at runtime."]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"qos-profiles-in-practice",children:"QoS Profiles in Practice"}),"\n",(0,i.jsxs)(r.p,{children:["Quality of Service (QoS) policies in ROS 2 allow you to define how messages are exchanged between publishers and subscribers. These policies are critical for managing reliability, latency, and resource usage in real-time robotic applications. ",(0,i.jsx)(r.code,{children:"rclpy"})," provides the ",(0,i.jsx)(r.code,{children:"QoSProfile"})," class and several common presets."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy\r\nfrom std_msgs.msg import String\r\n\r\nclass QoSNode(Node):\r\n    def __init__(self):\r\n        super().__init__('qos_node')\r\n\r\n        # Define a custom QoS profile\r\n        qos_profile = QoSProfile(\r\n            reliability=ReliabilityPolicy.RMW_QOS_POLICY_RELIABILITY_RELIABLE,\r\n            durability=DurabilityPolicy.RMW_QOS_POLICY_DURABILITY_TRANSIENT_LOCAL,\r\n            history=HistoryPolicy.RMW_QOS_POLICY_HISTORY_KEEP_LAST,\r\n            depth=10\r\n        )\r\n\r\n        # Publisher with custom QoS profile\r\n        self.publisher_ = self.create_publisher(String, 'qos_topic', qos_profile)\r\n        self.timer_ = self.create_timer(1.0, self.timer_callback)\r\n\r\n        # Subscriber with custom QoS profile (should match publisher for connection)\r\n        self.subscription_ = self.create_subscription(\r\n            String,\r\n            'qos_topic',\r\n            self.listener_callback,\r\n            qos_profile)\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello with QoS'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info(f'Received: \"{msg.data}\"')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = QoSNode()\r\n    rclpy.spin(node)\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.p,{children:"Key QoS Policies:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Reliability"}),": ",(0,i.jsx)(r.code,{children:"RMW_QOS_POLICY_RELIABILITY_RELIABLE"})," (guarantees delivery) vs. ",(0,i.jsx)(r.code,{children:"RMW_QOS_POLICY_RELIABILITY_BEST_EFFORT"})," (no guarantee, faster)."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Durability"}),": ",(0,i.jsx)(r.code,{children:"RMW_QOS_POLICY_DURABILITY_TRANSIENT_LOCAL"})," (messages persist for new subscribers) vs. ",(0,i.jsx)(r.code,{children:"RMW_QOS_POLICY_DURABILITY_VOLATILE"})," (only current subscribers receive)."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"History"}),": ",(0,i.jsx)(r.code,{children:"RMW_QOS_POLICY_HISTORY_KEEP_LAST"})," (keep last N messages) vs. ",(0,i.jsx)(r.code,{children:"RMW_QOS_POLICY_HISTORY_KEEP_ALL"})," (keep all messages)."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Depth"}),": Number of messages to keep if ",(0,i.jsx)(r.code,{children:"HistoryPolicy.RMW_QOS_POLICY_HISTORY_KEEP_LAST"})," is used."]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Common Presets:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"QoSProfile.DEFAULT_QOS"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"QoSProfile.SERVICES_DEFAULT"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"QoSProfile.PARAMETERS"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"QoSProfile.SENSOR_DATA"})}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"debugging-techniques",children:"Debugging Techniques"}),"\n",(0,i.jsxs)(r.p,{children:["Debugging ROS 2 nodes is crucial for identifying and resolving issues in your robotic applications. ",(0,i.jsx)(r.code,{children:"rclpy"})," and the ROS 2 CLI tools provide several mechanisms to help with this."]}),"\n",(0,i.jsx)(r.h4,{id:"using-ros-2-cli-tools",children:"Using ROS 2 CLI Tools"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"ros2 node list"})}),": Lists all active nodes in the ROS 2 graph. Use this to ensure your node is running."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"ros2 topic list"})}),": Shows all active topics. Use ",(0,i.jsx)(r.code,{children:"ros2 topic echo <topic_name>"})," to inspect messages being published on a topic."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"ros2 service list"})}),": Lists active services. Use ",(0,i.jsx)(r.code,{children:"ros2 service call <service_name> <service_type> <arguments>"})," to test service servers."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"ros2 param list"})}),": Lists parameters for a specific node. Use ",(0,i.jsx)(r.code,{children:"ros2 param get <node_name> <parameter_name>"})," and ",(0,i.jsx)(r.code,{children:"ros2 param set <node_name> <parameter_name> <value>"})," to inspect and modify parameters at runtime."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:(0,i.jsx)(r.code,{children:"ros2 launch"})}),": For complex systems, ",(0,i.jsx)(r.code,{children:"ros2 launch <package_name> <launch_file>"})," is essential. Debugging launch files often involves checking the output for errors and ensuring all nodes start correctly."]}),"\n"]}),"\n",(0,i.jsx)(r.h4,{id:"recommended-vs-code-debugging-features",children:"Recommended VS Code Debugging Features"}),"\n",(0,i.jsx)(r.p,{children:"For Python nodes, VS Code with the appropriate Python and ROS extensions provides powerful debugging capabilities:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Breakpoints"}),": Set breakpoints in your Python code to pause execution and inspect variables."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Variable Inspection"}),": Examine the values of variables at breakpoints."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Step-through Debugging"}),": Step into, over, or out of functions to follow the execution flow."]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Call Stack"}),": View the sequence of function calls that led to the current point of execution."]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Note for alternative IDE users"}),": If you are using ",(0,i.jsx)(r.code,{children:"vim"}),", ",(0,i.jsx)(r.code,{children:"emacs"}),", ",(0,i.jsx)(r.code,{children:"PyCharm"}),", or other IDEs, you are responsible for adapting these debugging instructions to your chosen environment. The principles remain the same: leverage breakpoints, inspect variables, and step through code execution."]})]})}function h(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>t});var s=n(6540);const i={},l=s.createContext(i);function c(e){const r=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(l.Provider,{value:r},e.children)}}}]);